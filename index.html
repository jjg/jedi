<!DOCTYPE html>
<html>
	<head>
		<title>jedi</title>
		<script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jedi.js" type="text/javascript" charset="utf-8"></script>
		<style>
			#editor {
				width:100%;
				height:600px;
			}
			#filename {
				width:600px;
			}
		</style>
	</head>
	<body>

		<input id="filename" type="text"><button id="load" onClick="loadClick()">load</button>&nbsp;<button id="save" onClick="saveClick()">save</button>

		<div id="editor"></div>
	
		<script>

			// init editor
			var editor = ace.edit('editor');
			editor.setTheme('ace/theme/cobalt');
			editor.getSession().setMode('ace/mode/text');
			editor.setHighlightActiveLine(false);
			editor.setShowPrintMargin(false);
			editor.getSession().setUseSoftTabs(false);
			
			// grab ui controls
			var loadButton = document.getElementById('load');
			var saveButton = document.getElementById('save');

			// control event handlers
			function loadClick(){

				var fileToLoad = document.getElementById('filename').value;

				// try and set the correct editor mode
				editMode = 'text';
				
				switch(fileToLoad.substring(fileToLoad.lastIndexOf('.') + 1)){
				
					case 'html':
						editMode = 'html';
						break;
						
					case 'js':
						editMode = 'javascript';
						break;
						
					case 'json':
						editMode = 'json';
						break;
						
					default:
						editMode = 'text';
				}
				
				editModeString = 'ace/mode/' + editMode;
				editor.getSession().setMode(editModeString);
					
				loadFile(fileToLoad, function(contents){
					editor.setValue(contents);
					editor.gotoLine(1);
				});

			}

			function saveClick(){
			
				saveButton.innerHTML = 'saving';
					
				var fileToSave = document.getElementById('filename').value;
				
				saveFile(fileToSave, editor.getValue(), function(result){
					
					if(result){
						saveButton.innerHTML = 'save';
					} else {
						alert('Error saving file');
					}
				
				});
			}

		</script>

	</body>
</html>

